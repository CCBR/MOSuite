<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Plot expression heatmap — plot_expr_heatmap • MOSuite</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Roboto-0.4.10/font.css" rel="stylesheet"><link href="../deps/Roboto_Mono-0.4.10/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Plot expression heatmap — plot_expr_heatmap"><meta name="description" content="The samples (i.e. the columns) are clustered in an unsupervised fashion based
on how similar their expression profiles are across the included genes. This
can help identify samples that are non clustering with their group as you
might expect based on the experimental design."><meta property="og:description" content="The samples (i.e. the columns) are clustered in an unsupervised fashion based
on how similar their expression profiles are across the included genes. This
can help identify samples that are non clustering with their group as you
might expect based on the experimental design."><meta name="robots" content="noindex"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">MOSuite</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">0.2.1.9001</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/intro.html">Introduction to MultiOmicsSuite</a></li>
    <li><a class="dropdown-item" href="../articles/renee.html">RSEM counts from RENEE</a></li>
    <li><a class="dropdown-item" href="../articles/visualization.html">Visualization with built-in plots</a></li>
    <li><a class="dropdown-item" href="../articles/cli.html">Calling MOSuite from the CLI</a></li>
    <li><a class="dropdown-item" href="../articles/memory.html">Memory Usage</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/CCBR/MOSuite/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Plot expression heatmap</h1>
      <small class="dont-index">Source: <a href="https://github.com/CCBR/MOSuite/blob/main/R/plot_heatmap.R" class="external-link"><code>R/plot_heatmap.R</code></a></small>
      <div class="d-none name"><code>plot_expr_heatmap.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The samples (i.e. the columns) are clustered in an unsupervised fashion based
on how similar their expression profiles are across the included genes. This
can help identify samples that are non clustering with their group as you
might expect based on the experimental design.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">plot_expr_heatmap</span><span class="op">(</span></span>
<span>  <span class="va">moo_counts</span>,</span>
<span>  <span class="va">count_type</span>,</span>
<span>  sub_count_type <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  sample_metadata <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  sample_id_colname <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  feature_id_colname <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  group_colname <span class="op">=</span> <span class="st">"Group"</span>,</span>
<span>  label_colname <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  samples_to_include <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  color_values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#5954d6"</span>, <span class="st">"#e1562c"</span>, <span class="st">"#b80058"</span>, <span class="st">"#00c6f8"</span>, <span class="st">"#d163e6"</span>, <span class="st">"#00a76c"</span>,</span>
<span>    <span class="st">"#ff9287"</span>, <span class="st">"#008cf9"</span>, <span class="st">"#006e00"</span>, <span class="st">"#796880"</span>, <span class="st">"#FFA500"</span>, <span class="st">"#878500"</span><span class="op">)</span>,</span>
<span>  include_all_genes <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  filter_top_genes_by_variance <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  top_genes_by_variance_to_include <span class="op">=</span> <span class="fl">500</span>,</span>
<span>  specific_genes_to_include_in_heatmap <span class="op">=</span> <span class="st">"None"</span>,</span>
<span>  cluster_genes <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  gene_distance_metric <span class="op">=</span> <span class="st">"correlation"</span>,</span>
<span>  gene_clustering_method <span class="op">=</span> <span class="st">"average"</span>,</span>
<span>  display_gene_dendrograms <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  display_gene_names <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  center_and_rescale_expression <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  cluster_samples <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  arrange_sample_columns <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  order_by_gene_expression <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  gene_to_order_columns <span class="op">=</span> <span class="st">" "</span>,</span>
<span>  gene_expression_order <span class="op">=</span> <span class="st">"low_to_high"</span>,</span>
<span>  smpl_distance_metric <span class="op">=</span> <span class="st">"correlation"</span>,</span>
<span>  smpl_clustering_method <span class="op">=</span> <span class="st">"average"</span>,</span>
<span>  display_smpl_dendrograms <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  reorder_dendrogram <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  reorder_dendrogram_order <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  display_sample_names <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  group_columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Group"</span>, <span class="st">"Replicate"</span>, <span class="st">"Batch"</span><span class="op">)</span>,</span>
<span>  assign_group_colors <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  assign_color_to_sample_groups <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  group_colors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#5954d6"</span>, <span class="st">"#e1562c"</span>, <span class="st">"#b80058"</span>, <span class="st">"#00c6f8"</span>, <span class="st">"#d163e6"</span>, <span class="st">"#00a76c"</span>,</span>
<span>    <span class="st">"#ff9287"</span>, <span class="st">"#008cf9"</span>, <span class="st">"#006e00"</span>, <span class="st">"#796880"</span>, <span class="st">"#FFA500"</span>, <span class="st">"#878500"</span><span class="op">)</span>,</span>
<span>  heatmap_color_scheme <span class="op">=</span> <span class="st">"Default"</span>,</span>
<span>  autoscale_heatmap_color <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  set_min_heatmap_color <span class="op">=</span> <span class="op">-</span><span class="fl">2</span>,</span>
<span>  set_max_heatmap_color <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  aspect_ratio <span class="op">=</span> <span class="st">"Auto"</span>,</span>
<span>  legend_font_size <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  gene_name_font_size <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  sample_name_font_size <span class="op">=</span> <span class="fl">8</span>,</span>
<span>  display_numbers <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  plot_filename <span class="op">=</span> <span class="st">"expr_heatmap.png"</span>,</span>
<span>  print_plots <span class="op">=</span> <span class="fu">options</span><span class="fu">::</span><span class="fu"><a href="https://dgkf.github.io/options/reference/opt.html" class="external-link">opt</a></span><span class="op">(</span><span class="st">"print_plots"</span><span class="op">)</span>,</span>
<span>  save_plots <span class="op">=</span> <span class="fu">options</span><span class="fu">::</span><span class="fu"><a href="https://dgkf.github.io/options/reference/opt.html" class="external-link">opt</a></span><span class="op">(</span><span class="st">"save_plots"</span><span class="op">)</span>,</span>
<span>  plots_subdir <span class="op">=</span> <span class="st">"heatmap"</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-moo-counts">moo_counts<a class="anchor" aria-label="anchor" href="#arg-moo-counts"></a></dt>
<dd><p>counts dataframe or <code>multiOmicDataSet</code> containing <code>count_type</code> &amp; <code>sub_count_type</code> in the counts
slot</p></dd>


<dt id="arg-count-type">count_type<a class="anchor" aria-label="anchor" href="#arg-count-type"></a></dt>
<dd><p>the type of counts to use. Must be a name in the counts slot (<code>names(moo@counts)</code>).</p></dd>


<dt id="arg-sub-count-type">sub_count_type<a class="anchor" aria-label="anchor" href="#arg-sub-count-type"></a></dt>
<dd><p>used if <code>count_type</code> is a list in the counts slot: specify the sub count type within the list.
Must be a name in <code>names(moo@counts[[count_type]])</code>.</p></dd>


<dt id="arg-sample-metadata">sample_metadata<a class="anchor" aria-label="anchor" href="#arg-sample-metadata"></a></dt>
<dd><p>sample metadata as a data frame or tibble (only required if <code>moo_counts</code> is a dataframe)</p></dd>


<dt id="arg-sample-id-colname">sample_id_colname<a class="anchor" aria-label="anchor" href="#arg-sample-id-colname"></a></dt>
<dd><p>The column from the sample metadata containing the sample names. The names in this column
must exactly match the names used as the sample column names of your input Counts Matrix. (Default: <code>NULL</code> - first
column in the sample metadata will be used.)</p></dd>


<dt id="arg-feature-id-colname">feature_id_colname<a class="anchor" aria-label="anchor" href="#arg-feature-id-colname"></a></dt>
<dd><p>The column from the counts dataa containing the Feature IDs (Usually Gene or Protein ID).
This is usually the first column of your input Counts Matrix. Only columns of Text type from your input Counts
Matrix will be available to select for this parameter. (Default: <code>NULL</code> - first column in the counts matrix will be
used.)</p></dd>


<dt id="arg-group-colname">group_colname<a class="anchor" aria-label="anchor" href="#arg-group-colname"></a></dt>
<dd><p>The column from the sample metadata containing the sample group information. This is usually a
column showing to which experimental treatments each sample belongs (e.g. WildType, Knockout, Tumor, Normal,
Before, After, etc.).</p></dd>


<dt id="arg-label-colname">label_colname<a class="anchor" aria-label="anchor" href="#arg-label-colname"></a></dt>
<dd><p>The column from the sample metadata containing the sample labels as you wish them to appear in
the plots produced by this template. This can be the same Sample Names Column. However, you may desire different
labels to display on your figure (e.g. shorter labels are sometimes preferred on plots). In that case, select the
column with your preferred Labels here. The selected column should contain unique names for each sample. (Default:
<code>NULL</code> – <code>sample_id_colname</code> will be used.)</p></dd>


<dt id="arg-samples-to-include">samples_to_include<a class="anchor" aria-label="anchor" href="#arg-samples-to-include"></a></dt>
<dd><p>Which samples would you like to include? Usually, you will choose all sample columns, or
you could choose to remove certain samples. Samples excluded here will be removed in this step and from further
analysis downstream of this step. (Default: <code>NULL</code> - all sample IDs in <code>moo@sample_meta</code> will be used.)</p></dd>


<dt id="arg-color-values">color_values<a class="anchor" aria-label="anchor" href="#arg-color-values"></a></dt>
<dd><p>vector of colors as hex values or names recognized by R</p></dd>


<dt id="arg-include-all-genes">include_all_genes<a class="anchor" aria-label="anchor" href="#arg-include-all-genes"></a></dt>
<dd><p>Set to TRUE if all genes are to be included. Set to FALSE if you want to filter genes by
variance and/or provide a list of specific genes that will appear in the heatmap.</p></dd>


<dt id="arg-filter-top-genes-by-variance">filter_top_genes_by_variance<a class="anchor" aria-label="anchor" href="#arg-filter-top-genes-by-variance"></a></dt>
<dd><p>Set to TRUE if you want to only include the top genes by variance. Set to FALSE
if you do not want to filter genes by variance.</p></dd>


<dt id="arg-top-genes-by-variance-to-include">top_genes_by_variance_to_include<a class="anchor" aria-label="anchor" href="#arg-top-genes-by-variance-to-include"></a></dt>
<dd><p>The number of genes to include if filtering genes by variance. This parameter
is ignored if "Filter top genes by variance" is set to FALSE.</p></dd>


<dt id="arg-specific-genes-to-include-in-heatmap">specific_genes_to_include_in_heatmap<a class="anchor" aria-label="anchor" href="#arg-specific-genes-to-include-in-heatmap"></a></dt>
<dd><p>Enter the gene symbols to be included in the heatmap, with each gene
symbol separated with a space from the others. Alternatively, paste in a column of gene names from any spreadsheet
application. This parameter is ignored if "Include all genes" is set to TRUE.</p></dd>


<dt id="arg-cluster-genes">cluster_genes<a class="anchor" aria-label="anchor" href="#arg-cluster-genes"></a></dt>
<dd><p>Choose whether to cluster the rows (genes). If TRUE, rows will have clustering applied. If
FALSE, clustering will not be applied to rows.</p></dd>


<dt id="arg-gene-distance-metric">gene_distance_metric<a class="anchor" aria-label="anchor" href="#arg-gene-distance-metric"></a></dt>
<dd><p>Distance metric to be used in clustering genes. (TODO document options)</p></dd>


<dt id="arg-gene-clustering-method">gene_clustering_method<a class="anchor" aria-label="anchor" href="#arg-gene-clustering-method"></a></dt>
<dd><p>Clustering method metric to be used in clustering samples. (TODO document options)</p></dd>


<dt id="arg-display-gene-dendrograms">display_gene_dendrograms<a class="anchor" aria-label="anchor" href="#arg-display-gene-dendrograms"></a></dt>
<dd><p>Set to TRUE to show gene dendrograms. Set to FALSE to hide dendrograms.</p></dd>


<dt id="arg-display-gene-names">display_gene_names<a class="anchor" aria-label="anchor" href="#arg-display-gene-names"></a></dt>
<dd><p>Set to TRUE to display gene names on the right side of the heatmap. Set to FALSE to hide
gene names.</p></dd>


<dt id="arg-center-and-rescale-expression">center_and_rescale_expression<a class="anchor" aria-label="anchor" href="#arg-center-and-rescale-expression"></a></dt>
<dd><p>Center and rescale expression for each gene across all included samples.</p></dd>


<dt id="arg-cluster-samples">cluster_samples<a class="anchor" aria-label="anchor" href="#arg-cluster-samples"></a></dt>
<dd><p>Choose whether to cluster the columns (samples). If TRUE, columns will have clustering
applied. If FALSE, clustering will not be applied to columns.</p></dd>


<dt id="arg-arrange-sample-columns">arrange_sample_columns<a class="anchor" aria-label="anchor" href="#arg-arrange-sample-columns"></a></dt>
<dd><p>If TRUE, arranges columns by annotation groups. If FALSE, and "Cluster Samples" is
FALSE, samples will appear in the order of input (samples to include)</p></dd>


<dt id="arg-order-by-gene-expression">order_by_gene_expression<a class="anchor" aria-label="anchor" href="#arg-order-by-gene-expression"></a></dt>
<dd><p>If TRUE, set gene name below and direction for ordering</p></dd>


<dt id="arg-gene-to-order-columns">gene_to_order_columns<a class="anchor" aria-label="anchor" href="#arg-gene-to-order-columns"></a></dt>
<dd><p>Gene to order columns by expression levels</p></dd>


<dt id="arg-gene-expression-order">gene_expression_order<a class="anchor" aria-label="anchor" href="#arg-gene-expression-order"></a></dt>
<dd><p>Choose direction for gene order</p></dd>


<dt id="arg-smpl-distance-metric">smpl_distance_metric<a class="anchor" aria-label="anchor" href="#arg-smpl-distance-metric"></a></dt>
<dd><p>Distance metric to be used in clustering samples.  (TODO document options)</p></dd>


<dt id="arg-smpl-clustering-method">smpl_clustering_method<a class="anchor" aria-label="anchor" href="#arg-smpl-clustering-method"></a></dt>
<dd><p>Clustering method to be used in clustering samples.  (TODO document options)</p></dd>


<dt id="arg-display-smpl-dendrograms">display_smpl_dendrograms<a class="anchor" aria-label="anchor" href="#arg-display-smpl-dendrograms"></a></dt>
<dd><p>Set to TRUE to show sample dendrograms. Set to FALSE to hide dendrogram.</p></dd>


<dt id="arg-reorder-dendrogram">reorder_dendrogram<a class="anchor" aria-label="anchor" href="#arg-reorder-dendrogram"></a></dt>
<dd><p>If TRUE, set the order of the dendrogram (below)</p></dd>


<dt id="arg-reorder-dendrogram-order">reorder_dendrogram_order<a class="anchor" aria-label="anchor" href="#arg-reorder-dendrogram-order"></a></dt>
<dd><p>Reorder the samples (columns) of the dendrogram by name, e.g.
“sample2”,“sample3",“sample1".</p></dd>


<dt id="arg-display-sample-names">display_sample_names<a class="anchor" aria-label="anchor" href="#arg-display-sample-names"></a></dt>
<dd><p>Set to TRUE if you want sample names to be displayed on the plot. Set to FALSE to hide
sample names.</p></dd>


<dt id="arg-group-columns">group_columns<a class="anchor" aria-label="anchor" href="#arg-group-columns"></a></dt>
<dd><p>Columns containing the sample groups for annotation tracks</p></dd>


<dt id="arg-assign-group-colors">assign_group_colors<a class="anchor" aria-label="anchor" href="#arg-assign-group-colors"></a></dt>
<dd><p>If TRUE, set the groups assigned colors (below)</p></dd>


<dt id="arg-assign-color-to-sample-groups">assign_color_to_sample_groups<a class="anchor" aria-label="anchor" href="#arg-assign-color-to-sample-groups"></a></dt>
<dd><p>Enter each sample to color in the format: group_name: color This parameter is
ignored if "Assign Colors" is set to FALSE.</p></dd>


<dt id="arg-group-colors">group_colors<a class="anchor" aria-label="anchor" href="#arg-group-colors"></a></dt>
<dd><p>Set group annotation colors.</p></dd>


<dt id="arg-heatmap-color-scheme">heatmap_color_scheme<a class="anchor" aria-label="anchor" href="#arg-heatmap-color-scheme"></a></dt>
<dd><p>color scheme (TODO document options)</p></dd>


<dt id="arg-autoscale-heatmap-color">autoscale_heatmap_color<a class="anchor" aria-label="anchor" href="#arg-autoscale-heatmap-color"></a></dt>
<dd><p>Set to TRUE to autoscale the heatmap colors between the maximum and minimum heatmap
color parameters. If FALSE, set the heatmap colors between "Set max heatmap color" and "Set min heatmap color"
(below).</p></dd>


<dt id="arg-set-min-heatmap-color">set_min_heatmap_color<a class="anchor" aria-label="anchor" href="#arg-set-min-heatmap-color"></a></dt>
<dd><p>If Autoscale heatmap color is set to FALSE, set the minimum heatmap z-score value</p></dd>


<dt id="arg-set-max-heatmap-color">set_max_heatmap_color<a class="anchor" aria-label="anchor" href="#arg-set-max-heatmap-color"></a></dt>
<dd><p>If Autoscale heatmap color is set to FALSE, set the maximum heatmap z-score value.</p></dd>


<dt id="arg-aspect-ratio">aspect_ratio<a class="anchor" aria-label="anchor" href="#arg-aspect-ratio"></a></dt>
<dd><p>Set figure Aspect Ratio. Ratio refers to entire figure including legend. If set to Auto figure
size is based on number of rows and columns form counts matrix. default - Auto</p></dd>


<dt id="arg-legend-font-size">legend_font_size<a class="anchor" aria-label="anchor" href="#arg-legend-font-size"></a></dt>
<dd><p>Set Font size for figure legend. Default is 10.</p></dd>


<dt id="arg-gene-name-font-size">gene_name_font_size<a class="anchor" aria-label="anchor" href="#arg-gene-name-font-size"></a></dt>
<dd><p>Font size for gene names. If you don't want gene labels to show, toggle "Display Gene
Names" below to FALSE</p></dd>


<dt id="arg-sample-name-font-size">sample_name_font_size<a class="anchor" aria-label="anchor" href="#arg-sample-name-font-size"></a></dt>
<dd><p>Font size for sample names. If you don't want to display samples names, toggle "Display
sample names" (below) to FALSE</p></dd>


<dt id="arg-display-numbers">display_numbers<a class="anchor" aria-label="anchor" href="#arg-display-numbers"></a></dt>
<dd><p>Setting to FALSE (default) will not display numerical value of heat on heatmap. Set to TRUE if
you want to see these numbers on the plot.</p></dd>


<dt id="arg-plot-filename">plot_filename<a class="anchor" aria-label="anchor" href="#arg-plot-filename"></a></dt>
<dd><p>plot output filename - only used if save_plots is TRUE</p></dd>


<dt id="arg-print-plots">print_plots<a class="anchor" aria-label="anchor" href="#arg-print-plots"></a></dt>
<dd><p>Whether to print plots during analysis (Defaults to <code>FALSE</code>, overwritable using option 'moo_print_plots' or environment variable 'MOO_PRINT_PLOTS')</p></dd>


<dt id="arg-save-plots">save_plots<a class="anchor" aria-label="anchor" href="#arg-save-plots"></a></dt>
<dd><p>Whether to save plots to files during analysis (Defaults to <code>TRUE</code>, overwritable using option 'moo_save_plots' or environment variable 'MOO_SAVE_PLOTS')</p></dd>


<dt id="arg-plots-subdir">plots_subdir<a class="anchor" aria-label="anchor" href="#arg-plots-subdir"></a></dt>
<dd><p>subdirectory in <code>figures/</code> where plots will be saved if <code>save_plots</code> is <code>TRUE</code></p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>heatmap from <code><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html" class="external-link">ComplexHeatmap::Heatmap()</a></code></p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>By default, the top 500 genes by variance are used, as these are
generally going to include those genes that most distinguish your samples
from one another. You can change this as well as many other parameters about
this heatmap if you explore the advanced options.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other plotters:
<code><a href="plot_corr_heatmap.html">plot_corr_heatmap()</a></code>,
<code><a href="plot_histogram.html">plot_histogram()</a></code>,
<code><a href="plot_pca.html">plot_pca()</a></code>,
<code><a href="plot_read_depth.html">plot_read_depth()</a></code>,
<code><a href="print_or_save_plot.html">print_or_save_plot()</a></code></p>
<p>Other heatmaps:
<code><a href="plot_corr_heatmap.html">plot_corr_heatmap()</a></code></p>
<p>Other moo methods:
<code><a href="batch_correct_counts.html">batch_correct_counts()</a></code>,
<code><a href="clean_raw_counts.html">clean_raw_counts()</a></code>,
<code><a href="diff_counts.html">diff_counts()</a></code>,
<code><a href="filter_counts.html">filter_counts()</a></code>,
<code><a href="filter_diff.html">filter_diff()</a></code>,
<code><a href="normalize_counts.html">normalize_counts()</a></code>,
<code><a href="plot_corr_heatmap.html">plot_corr_heatmap()</a></code>,
<code><a href="plot_histogram.html">plot_histogram()</a></code>,
<code><a href="plot_pca.html">plot_pca()</a></code>,
<code><a href="plot_read_depth.html">plot_read_depth()</a></code>,
<code><a href="run_deseq2.html">run_deseq2()</a></code>,
<code><a href="set_color_pal.html">set_color_pal()</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># plot expression heatmap for a counts slot in a multiOmicDataset Object</span></span></span>
<span class="r-in"><span><span class="va">moo</span> <span class="op">&lt;-</span> <span class="fu"><a href="multiOmicDataSet.html">multiOmicDataSet</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  sample_metadata <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">nidap_sample_metadata</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  anno_dat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  counts_lst <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="st">"raw"</span> <span class="op">=</span> <span class="va">nidap_raw_counts</span>,</span></span>
<span class="r-in"><span>    <span class="st">"norm"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>      <span class="st">"voom"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">nidap_norm_counts</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">plot_expr_heatmap</span><span class="op">(</span><span class="va">moo</span>, count_type <span class="op">=</span> <span class="st">"norm"</span>, sub_count_type <span class="op">=</span> <span class="st">"voom"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The total number of genes in heatmap: 500</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># customize the plot</span></span></span>
<span class="r-in"><span><span class="fu">plot_expr_heatmap</span><span class="op">(</span><span class="va">moo</span>,</span></span>
<span class="r-in"><span>  count_type <span class="op">=</span> <span class="st">"norm"</span>, sub_count_type <span class="op">=</span> <span class="st">"voom"</span>,</span></span>
<span class="r-in"><span>  top_genes_by_variance_to_include <span class="op">=</span> <span class="fl">100</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The total number of genes in heatmap: 100</span>
<span class="r-plt img"><img src="plot_expr_heatmap-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># plot expression heatmap for a counts dataframe</span></span></span>
<span class="r-in"><span><span class="va">counts_dat</span> <span class="op">&lt;-</span> <span class="va">moo</span><span class="op">@</span><span class="va">counts</span><span class="op">$</span><span class="va">norm</span><span class="op">$</span><span class="va">voom</span></span></span>
<span class="r-in"><span><span class="fu">plot_expr_heatmap</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">counts_dat</span>,</span></span>
<span class="r-in"><span>  sample_metadata <span class="op">=</span> <span class="va">nidap_sample_metadata</span>,</span></span>
<span class="r-in"><span>  sample_id_colname <span class="op">=</span> <span class="st">"Sample"</span>,</span></span>
<span class="r-in"><span>  feature_id_colname <span class="op">=</span> <span class="st">"Gene"</span>,</span></span>
<span class="r-in"><span>  group_colname <span class="op">=</span> <span class="st">"Group"</span>,</span></span>
<span class="r-in"><span>  label_colname <span class="op">=</span> <span class="st">"Label"</span>,</span></span>
<span class="r-in"><span>  top_genes_by_variance_to_include <span class="op">=</span> <span class="fl">100</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The total number of genes in heatmap: 100</span>
<span class="r-plt img"><img src="plot_expr_heatmap-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Created by the <a href="https://github.com/CCBR" class="external-link">CCR Collaborative Bioinformatics Resource</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

