% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/differential.R
\name{filter_diff}
\alias{filter_diff}
\title{Filter features from differential analysis based on statistical significance}
\usage{
filter_diff(
  moo,
  feature_id_colname = NULL,
  significance_column = "adjpval",
  significance_cutoff = 0.05,
  change_column = "logFC",
  change_cutoff = 1,
  filtering_mode = "any",
  include_estimates = c("FC", "logFC", "tstat", "pval", "adjpval"),
  round_estimates = TRUE,
  rounding_decimal_for_percent_cells = 0,
  contrast_filter = "none",
  contrasts = c(),
  groups = c(),
  groups_filter = "none",
  label_font_size = 6,
  label_distance = 1,
  y_axis_expansion = 0.08,
  fill_colors = c("steelblue1", "whitesmoke"),
  pie_chart_in_3d = TRUE,
  bar_width = 0.4,
  draw_bar_border = TRUE,
  plot_type = "bar",
  plot_titles_fontsize = 12,
  print_plots = options::opt("print_plots"),
  save_plots = options::opt("save_plots"),
  plots_subdir = file.path("diff", "filt")
)
}
\arguments{
\item{moo}{multiOmicDataSet object (see \code{create_multiOmicDataSet_from_dataframes()})}

\item{feature_id_colname}{The column from the counts data containing the Feature IDs (Usually Gene or Protein ID). This is usually the first column of your input Counts Matrix. Only columns of Text type from your input Counts Matrix will be available to select for this parameter. (Default: \code{NULL} - first column in the counts matrix will be used.)}

\item{significance_column}{Column name for significance, e.g. \code{"pval"} or \code{"pvaladj"} (default)}

\item{significance_cutoff}{Features will only be kept if their \code{significance_column} is less then this cutoff threshold}

\item{change_column}{Column name for change, e.g. \code{"logFC"} (default)}

\item{change_cutoff}{Features will only be kept if the absolute value of their \code{change_column} is greater than or equal to this cutoff threshold}

\item{filtering_mode}{Accepted values: \code{"any"} or \code{"all"} to include features that meet the criteria in \emph{any} contrast or in \emph{all} contrasts}

\item{include_estimates}{Column names of estimates to include. Default: \code{c("FC", "logFC", "tstat", "pval", "adjpval")}}

\item{round_estimates}{Whether to round estimates. Default: \code{TRUE}}

\item{rounding_decimal_for_percent_cells}{Decimal place to use when rounding Percent cells}

\item{contrast_filter}{Whether to filter \code{contrasts} in or our of analysis. If \code{"keep"}, only the contrast names listed in \code{contrasts} will be included. If \verb{"remove}, the contrast names listed by \code{contrasts} will be removed. If \code{"none"}, all contrasts in the dataset are used. Options: \code{"keep"}, \code{"remove"}, or \code{"none"}}

\item{contrasts}{Contrast names to filter by \code{contrast_filter}. If \code{contrast_filter} is \code{"none"}, this parameter has no effect.}

\item{groups}{Group names to filter by \code{groups_filter}. If \code{groups_filter} is \code{"none"}, this parameter has no effect. Options: \code{"keep"}, \code{"remove"}, or \code{"none"}}

\item{groups_filter}{Whether to filter \code{groups} in or out of analysis. If \code{"keep"}, only the group names listed in \code{groups} will be included. If \code{"remove"}, the group names listed by \code{groups} will be removed. If \code{"none"}, all groups in the dataset are used.}

\item{label_font_size}{Font size for labels in the plot (default: 6)}

\item{label_distance}{Distance of labels from the bars (default: 1)}

\item{y_axis_expansion}{Expansion of the y-axis (default: 0.08)}

\item{fill_colors}{Fill colors for the bars (default: c("steelblue1", "whitesmoke"))}

\item{pie_chart_in_3d}{Whether to draw pie charts in 3D (default: TRUE)}

\item{bar_width}{Width of the bars (default: 0.4)}

\item{draw_bar_border}{Whether to draw borders around bars (default: TRUE)}

\item{plot_type}{"bar" or "pie"}

\item{plot_titles_fontsize}{Font size for plot titles (default: 12)}

\item{print_plots}{Whether to print plots during analysis (Defaults to \code{FALSE}, overwritable using option 'moo_print_plots' or environment variable 'MOO_PRINT_PLOTS')}

\item{save_plots}{Whether to save plots to files during analysis (Defaults to \code{FALSE}, overwritable using option 'moo_save_plots' or environment variable 'MOO_SAVE_PLOTS')}

\item{plots_subdir}{subdirectory in where plots will be saved if \code{save_plots} is \code{TRUE}}
}
\description{
Outputs dataset of significant genes from DEG table; filters genes based on statistical significance (p-value or adjusted p-value) and change (fold change, log2 fold change, or t-statistic); in addition allows for selection of DEG estimates and for sub-setting of contrasts and groups included in the output gene list.
}
\examples{
moo <- multiOmicDataSet(
  sample_metadata = as.data.frame(nidap_sample_metadata),
  anno_dat = data.frame(),
  counts_lst = list(
    "raw" = as.data.frame(nidap_raw_counts),
    "clean" = as.data.frame(nidap_clean_raw_counts),
    "filt" = as.data.frame(nidap_filtered_counts)
  )
) \%>\%
  diff_counts(
    count_type = "filt",
    sub_count_type = NULL,
    sample_id_colname = "Sample",
    feature_id_colname = "Gene",
    covariates_colnames = c("Group", "Batch"),
    contrast_colname = c("Group"),
    contrasts = c("B-A", "C-A", "B-C"),
    voom_normalization_method = "quantile",
  ) \%>\%
  filter_diff()
head(moo@analyses$diff_filt)
}
\seealso{
Other moo methods: 
\code{\link{batch_correct_counts}()},
\code{\link{clean_raw_counts}()},
\code{\link{diff_counts}()},
\code{\link{filter_counts}()},
\code{\link{normalize_counts}()},
\code{\link{plot_corr_heatmap}()},
\code{\link{plot_expr_heatmap}()},
\code{\link{plot_histogram}()},
\code{\link{plot_pca}()},
\code{\link{plot_read_depth}()},
\code{\link{run_deseq2}()},
\code{\link{set_color_pal}()}
}
\concept{moo methods}
